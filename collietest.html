<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
</head>
<body>
<div id="container"></div>
<script type="text/javascript" src="http://jindo.dev.naver.com/collie/deploy/collie.min.js"></script>
<script type="text/javascript">

collie.util.addEventListener(window, "load", function () {
	const windowWidth = 800;
	const windowHeight = 450;
	
    var layer = new collie.Layer({
        width: windowWidth,
        height: windowHeight
    });
	var handLayer = new collie.Layer({
        width: windowWidth,
        height: windowHeight
    });
	var character = new collie.Layer({
		width: windowWidth,
		height: windowHeight
	});
	var frameLayer = new collie.Layer({
        width: windowWidth,
        height: windowHeight
    });

    var oSelectedDisplayObject = null;
    var htStartPosition = {};
    var htSelectedDisplayObjectPosition = {};
    
    handLayer.attach({
        mousedown : function (oEvent) {
            if (oEvent.displayObject) {
                oEvent.displayObject.set({
                    scaleX : oEvent.displayObject.get("scale") * 1.2,
                    scaleY : oEvent.displayObject.get("scale") * 1.2
                });
                oSelectedDisplayObject = oEvent.displayObject;
                htStartPosition = {
                    x : oEvent.x,
                    y : oEvent.y 
                };
                htSelectedDisplayObjectPosition = {
                    x : oSelectedDisplayObject.get("x"),
                    y : oSelectedDisplayObject.get("y")
                };
            }
        },
        mouseup : function (oEvent) {
            if (oSelectedDisplayObject !== null) {
                oSelectedDisplayObject.set({
                    scaleX : oSelectedDisplayObject.get("scale"),
                    scaleY : oSelectedDisplayObject.get("scale")
                });
                oSelectedDisplayObject = null;
                htSelectedDisplayObjectPosition = htStartPosition = {};
                
                handLayer.removeChild(oEvent.displayObject);
                handLayer.addChild(oEvent.displayObject);
            }
        },
        /*mousemove : function (oEvent) {
            if (oSelectedDisplayObject !== null) {
                var x = htStartPosition.x - oEvent.x;
                var y = htStartPosition.y - oEvent.y;
                oSelectedDisplayObject.set({
                    x : htSelectedDisplayObjectPosition.x - x,
                    y : htSelectedDisplayObjectPosition.y - y
                });
            }
        }*/
    });

	collie.ImageManager.add({
		handLayerbackground: "C:/Users/Micah/TagTech/img/handbackground.png",
		actionbox1: "C:/Users/Micah/TagTech/img/actionbox.png",
		actionbox2: "C:/Users/Micah/TagTech/img/actionbox.png",
		actionbox3: "C:/Users/Micah/TagTech/img/actionbox.png",
		actionbox4: "C:/Users/Micah/TagTech/img/actionbox.png",
		mage: "C:/Users/Micah/TagTech/img/mage.png",
		warrior: "C:/Users/Micah/TagTech/img/warrior.png",
		warriorAttack: "C:/Users/Micah/TagTech/img/warrior.png",
		swordCard: "C:/Users/Micah/TagTech/img/swordCard.png",
		cardGlow: "C:/Users/Micah/TagTech/img/cardglow.png",
		frame: "C:/Users/Micah/TagTech/img/backgroundframe.png"
	});

	var handLayerbackground = new collie.DisplayObject({
		x: "center",
		width: windowWidth,
		height: windowHeight,
		backgroundImage: "handLayerbackground"
	}).addTo(layer);
	
	var cardScale = 8/4500 *windowHeight;
	var cardWidth = 150;
	var cardHeight = 200;
	var numCards = 8;
	
	var hand = new Array();
	var highlight = new Array();
	
	for(var i=0; i < numCards; i++) {
		var xPos, yPos;
		if(i < 4) {
			xPos = (windowWidth/5)*(i+1) - cardWidth/2;
			yPos = windowHeight / 4 - cardHeight / 2;
		} else {
			xPos = (windowWidth/5)*(i-3) - cardWidth/2;
			yPos = windowHeight * 3 / 4 - cardHeight / 2;
		}
		hand[i] = new collie.DisplayObject({
			x: xPos,
			y: yPos,
			width: cardWidth,
			height: cardHeight,
			useEvent : true,
			backgroundImage: "swordCard", 
			scaleX : cardScale,
			scaleY : cardScale, 
			scale: cardScale
		}).addTo(handLayer);
		highlight[i] = new collie.DisplayObject({
			x: hand[i].x-10,
			y: hand[i].y-10,
			width: cardWidth+20,
			height: cardHeight+20,
			backgroundImage: "cardGlow",
			useAutoStart : true,
			onStart : function() {
				highlight[i].set("visible", false);
			}
		}).addTo(hand[i]).attach({
			click : function () {
				print('Click Detected!');
				if(highlight[i].visible == false) {
					highlight[i].set("visible", true);
				} else {
					highlight[i].set("visible", false);
				}
			}
		});
	}
	
    /*var oTimerAttack = collie.Timer.cycle(warriorAttack, "10fps", {
        from : 0,
        to : 6,
        loop : 1,
        useAutoStart : false,
        onStart : function () {
            warriorStill.set("visible", false);
            warriorAttack.set("visible", true);
        },
        onComplete : function () {
            oTimer.start();
        }
    });*/
		
	var frame = new collie.DisplayObject({
		x: "center",
		width: windowWidth,
		height: windowHeight,
		backgroundImage: "frame"
	}).addTo(frameLayer);
	
	/*var currentY = swordCard.get("y");
	swordCard.attach({
		click: function (e) {
			collie.Timer.queue().
				transition(swordCard, 400, {
					to: currentY - 100,
					effect: collie.Effect.easeOut,
					set: "y"
				}).
				transition(swordCard, 400, {
					to: currentY,
					effect: collie.Effect.easeIn,
					set: "y"
				});
			
		}
	});*/

	collie.Renderer.addLayer(layer);
	collie.Renderer.addLayer(handLayer);
	collie.Renderer.addLayer(character);
	collie.Renderer.addLayer(frameLayer);
	collie.Renderer.load(document.getElementById("container"));
	collie.Renderer.start("30fps");
});
</script>
</body>
</html>